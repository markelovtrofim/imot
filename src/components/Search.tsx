import React, {FC, useState} from 'react';
import BlockBox from "./BlockBox";
import {Alert, Button, Snackbar, Typography} from "@mui/material";
import Select from './Select'
import {makeStyles} from "@mui/styles";
import LoadingButton from '@mui/lab/LoadingButton';
import SearchIcon from '@mui/icons-material/Search';
import {useAppSelector} from "../hooks/redux";
import {useDispatch} from "react-redux";
import {callsSlice, getBaseCallsData} from "../store/calls/calls.slice";
import SelectTwo from "./SelectTwo";
import {searchSlice} from "../store/search/search.slice";

const useStyles = makeStyles(({
  searchTitle: {
    height: '35px',
    display: 'flex',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: '15px'
  },

  searchTitleLeft: {
    display: 'flex',
    justifyContent: 'space-between',
    alignItems: 'center'
  },
  searchTitleLeftText: {},
  searchTitleLeftStick: {
    marginLeft: '16px !important',
    color: '#CDD5DF !important',
    fontSize: '17px !important'
  },

  searchTitleRight: {
    display: 'flex',
    alignItems: 'center'
  },
  searchDeleteAllButton: {
    display: 'flex',
    alignItems: 'center',
    marginRight: '40px',
    cursor: 'pointer'
  },
  searchDeleteAllButtonText: {
    color: '#2F3747 !important'
  },
  searchButtonIcon: {
    fill: '#722ED1 !important'
  },

  searchItems: {
    display: 'flex',
    width: '100%',
    flexWrap: 'wrap'
  },
  searchItem: {
    display: 'flex',
    alignItems: 'center',
    margin: '0 22px 16px 0'
  },
  searchText: {
    marginRight: '8px !important'
  },
  tagsBox: {
    minWidth: '70px',
    height: '32px',
    backgroundColor: '#F8FAFC',
    border: 'none !important',
    outline: 'none'
  }
}));

const FolderPlusSvg = (props: React.SVGProps<SVGSVGElement>) => {
  return (
    <svg width="185" height="22" viewBox="0 0 185 22" fill="none" xmlns="http://www.w3.org/2000/svg" {...props}>
      <path fillRule="evenodd" clipRule="evenodd"
            d="M16.7577 8.67277C17.1038 10.8629 17.079 13.0965 16.6843 15.2782C16.5404 16.0741 15.8813 16.6708 15.0822 16.7285L13.6209 16.8341C10.5605 17.0553 7.48852 17.0553 4.42814 16.8341L3.07734 16.7365C2.21323 16.6741 1.50051 16.0289 1.3448 15.1681C0.963241 13.0588 0.897923 10.9036 1.15102 8.77476L1.39414 6.72991C1.51149 5.74285 2.34055 5 3.32483 5H5.36936C6.25472 5 6.97244 5.72493 6.97244 6.61918C6.97244 6.64872 6.99615 6.67266 7.0254 6.67266H14.799C15.7453 6.67266 16.5513 7.36716 16.7005 8.31101L16.7577 8.67277ZM9.69369 9.7311C9.69369 9.35784 9.39408 9.05523 9.02454 9.05523C8.65498 9.05523 8.35538 9.35784 8.35538 9.7311V11.3081H6.79403C6.42447 11.3081 6.12488 11.6107 6.12488 11.984C6.12488 12.3573 6.42447 12.6599 6.79403 12.6599H8.35538V14.2369C8.35538 14.6102 8.65498 14.9128 9.02454 14.9128C9.39408 14.9128 9.69369 14.6102 9.69369 14.2369V12.6599H11.255C11.6246 12.6599 11.9242 12.3573 11.9242 11.984C11.9242 11.6107 11.6246 11.3081 11.255 11.3081H9.69369V9.7311Z"
            fill="#9254DE"/>
      <path
        d="M35.5753 9.12926H34.0241C33.9645 8.79782 33.8535 8.50615 33.6911 8.25426C33.5286 8.00237 33.3298 7.78859 33.0945 7.61293C32.8591 7.43726 32.5956 7.30469 32.304 7.2152C32.0156 7.12571 31.709 7.08097 31.3842 7.08097C30.7976 7.08097 30.2723 7.22846 29.8082 7.52344C29.3475 7.81842 28.983 8.25095 28.7145 8.82102C28.4493 9.3911 28.3168 10.0871 28.3168 10.9091C28.3168 11.7377 28.4493 12.437 28.7145 13.0071C28.983 13.5772 29.3492 14.008 29.8132 14.2997C30.2772 14.5914 30.7992 14.7372 31.3793 14.7372C31.7008 14.7372 32.0057 14.6941 32.294 14.608C32.5857 14.5185 32.8492 14.3875 33.0845 14.2152C33.3198 14.0429 33.5187 13.8324 33.6811 13.5838C33.8468 13.3319 33.9612 13.0436 34.0241 12.7188L35.5753 12.7237C35.4924 13.2242 35.3317 13.6849 35.093 14.1058C34.8577 14.5234 34.5545 14.8847 34.1832 15.1896C33.8153 15.4912 33.3944 15.7249 32.9205 15.8906C32.4465 16.0563 31.9295 16.1392 31.3693 16.1392C30.4877 16.1392 29.7022 15.9304 29.0128 15.5128C28.3234 15.0919 27.7798 14.4903 27.3821 13.7081C26.9877 12.9259 26.7905 11.9929 26.7905 10.9091C26.7905 9.82197 26.9893 8.88897 27.3871 8.11008C27.7848 7.32789 28.3284 6.72798 29.0178 6.31037C29.7071 5.88944 30.491 5.67898 31.3693 5.67898C31.9096 5.67898 32.4134 5.75687 32.8807 5.91264C33.3513 6.0651 33.7739 6.29048 34.1484 6.58878C34.523 6.88376 34.8329 7.24503 35.0781 7.67258C35.3234 8.09683 35.4891 8.58239 35.5753 9.12926ZM40.5108 16.1541C39.7949 16.1541 39.1702 15.9901 38.6365 15.6619C38.1029 15.3338 37.6886 14.8748 37.3936 14.2848C37.0987 13.6948 36.9512 13.0054 36.9512 12.2166C36.9512 11.4245 37.0987 10.7318 37.3936 10.1385C37.6886 9.54522 38.1029 9.08452 38.6365 8.75639C39.1702 8.42827 39.7949 8.2642 40.5108 8.2642C41.2267 8.2642 41.8515 8.42827 42.3851 8.75639C42.9187 9.08452 43.333 9.54522 43.628 10.1385C43.923 10.7318 44.0705 11.4245 44.0705 12.2166C44.0705 13.0054 43.923 13.6948 43.628 14.2848C43.333 14.8748 42.9187 15.3338 42.3851 15.6619C41.8515 15.9901 41.2267 16.1541 40.5108 16.1541ZM40.5158 14.9062C40.9798 14.9062 41.3643 14.7836 41.6692 14.5384C41.9741 14.2931 42.1995 13.9666 42.3453 13.5589C42.4945 13.1513 42.5691 12.7022 42.5691 12.2116C42.5691 11.7244 42.4945 11.277 42.3453 10.8693C42.1995 10.4583 41.9741 10.1286 41.6692 9.87997C41.3643 9.63139 40.9798 9.5071 40.5158 9.5071C40.0485 9.5071 39.6607 9.63139 39.3525 9.87997C39.0475 10.1286 38.8205 10.4583 38.6713 10.8693C38.5255 11.277 38.4526 11.7244 38.4526 12.2116C38.4526 12.7022 38.5255 13.1513 38.6713 13.5589C38.8205 13.9666 39.0475 14.2931 39.3525 14.5384C39.6607 14.7836 40.0485 14.9062 40.5158 14.9062ZM46.6023 8.36364L48.2876 11.3366L49.9879 8.36364H51.6136L49.2322 12.1818L51.6335 16H50.0078L48.2876 13.1463L46.5724 16H44.9418L47.3182 12.1818L44.9716 8.36364H46.6023ZM53.1399 18.8636V8.36364H54.5916V9.60156H54.7159C54.8021 9.44247 54.9264 9.25852 55.0888 9.04972C55.2512 8.84091 55.4766 8.65862 55.7649 8.50284C56.0533 8.34375 56.4344 8.2642 56.9084 8.2642C57.5249 8.2642 58.075 8.41998 58.5589 8.73153C59.0429 9.04309 59.4223 9.49219 59.6974 10.0788C59.9759 10.6655 60.1151 11.3714 60.1151 12.1967C60.1151 13.022 59.9775 13.7296 59.7024 14.3196C59.4273 14.9062 59.0495 15.3587 58.5689 15.6768C58.0883 15.9917 57.5398 16.1491 56.9233 16.1491C56.4593 16.1491 56.0798 16.0713 55.7848 15.9155C55.4931 15.7597 55.2644 15.5774 55.0987 15.3686C54.933 15.1598 54.8054 14.9742 54.7159 14.8118H54.6264V18.8636H53.1399ZM54.5966 12.1818C54.5966 12.7187 54.6745 13.1894 54.8303 13.5938C54.986 13.9981 55.2114 14.3146 55.5064 14.5433C55.8014 14.7687 56.1626 14.8814 56.5902 14.8814C57.0343 14.8814 57.4055 14.7637 57.7038 14.5284C58.0021 14.2898 58.2275 13.9666 58.38 13.5589C58.5357 13.1513 58.6136 12.6922 58.6136 12.1818C58.6136 11.678 58.5374 11.2256 58.3849 10.8246C58.2358 10.4235 58.0104 10.107 57.7088 9.875C57.4105 9.64299 57.0376 9.52699 56.5902 9.52699C56.1593 9.52699 55.7947 9.63802 55.4964 9.86009C55.2015 10.0821 54.9777 10.392 54.8253 10.7898C54.6728 11.1875 54.5966 11.6515 54.5966 12.1818ZM64.0028 16.169C63.5189 16.169 63.0814 16.0795 62.6903 15.9006C62.2992 15.7183 61.9893 15.4548 61.7607 15.1101C61.5353 14.7654 61.4226 14.3428 61.4226 13.8423C61.4226 13.4115 61.5054 13.0568 61.6712 12.7784C61.8369 12.5 62.0606 12.2796 62.3423 12.1172C62.6241 11.9548 62.9389 11.8321 63.2869 11.7493C63.6349 11.6664 63.9896 11.6035 64.3509 11.5604C64.8082 11.5073 65.1795 11.4643 65.4645 11.4311C65.7495 11.3946 65.9567 11.3366 66.0859 11.2571C66.2152 11.1776 66.2798 11.0483 66.2798 10.8693V10.8345C66.2798 10.4003 66.1572 10.0639 65.9119 9.82528C65.67 9.58665 65.3087 9.46733 64.8281 9.46733C64.3277 9.46733 63.9332 9.57836 63.6449 9.80043C63.3598 10.0192 63.1626 10.2628 63.0533 10.5312L61.6562 10.2131C61.822 9.74905 62.0639 9.37453 62.3821 9.08949C62.7036 8.80114 63.0732 8.59233 63.4908 8.46307C63.9084 8.33049 64.3475 8.2642 64.8082 8.2642C65.1132 8.2642 65.4363 8.30066 65.7777 8.37358C66.1224 8.44318 66.4439 8.57244 66.7422 8.76136C67.0438 8.95028 67.2907 9.22041 67.483 9.57173C67.6752 9.91974 67.7713 10.3722 67.7713 10.929V16H66.3196V14.956H66.2599C66.1638 15.1482 66.0196 15.3371 65.8274 15.5227C65.6352 15.7083 65.3883 15.8625 65.0866 15.9851C64.785 16.1077 64.4238 16.169 64.0028 16.169ZM64.326 14.9759C64.737 14.9759 65.0883 14.8946 65.38 14.7322C65.675 14.5698 65.8987 14.3577 66.0511 14.0959C66.2069 13.8307 66.2848 13.5473 66.2848 13.2457V12.2614C66.2318 12.3144 66.129 12.3641 65.9766 12.4105C65.8274 12.4536 65.6567 12.4917 65.4645 12.5249C65.2723 12.5547 65.085 12.5829 64.9027 12.6094C64.7204 12.6326 64.5679 12.6525 64.4453 12.669C64.157 12.7055 63.8935 12.7668 63.6548 12.853C63.4195 12.9392 63.2306 13.0634 63.0881 13.2259C62.9489 13.3849 62.8793 13.5971 62.8793 13.8622C62.8793 14.2301 63.0152 14.5085 63.2869 14.6974C63.5587 14.883 63.9051 14.9759 64.326 14.9759ZM74.9267 11.5405V12.8281H70.7903V11.5405H74.9267ZM71.2079 8.36364V16H69.7512V8.36364H71.2079ZM75.9657 8.36364V16H74.514V8.36364H75.9657ZM79.411 13.9169L82.7768 8.36364H84.3777V16H82.921V10.4418L79.5701 16H77.9544V8.36364H79.411V13.9169ZM85.4292 9.64631V8.36364H91.8723V9.64631H89.3816V16H87.9299V9.64631H85.4292ZM94.5632 10.9886H96.7805C97.7152 10.9886 98.4344 11.2206 98.9382 11.6847C99.442 12.1487 99.6939 12.7469 99.6939 13.4794C99.6939 13.9567 99.5812 14.3859 99.3558 14.767C99.1304 15.1482 98.8007 15.4498 98.3665 15.6719C97.9323 15.8906 97.4036 16 96.7805 16H93.4446V8.36364H94.9013V14.7173H96.7805C97.2081 14.7173 97.5594 14.6063 97.8345 14.3842C98.1096 14.1589 98.2472 13.8722 98.2472 13.5241C98.2472 13.1562 98.1096 12.8563 97.8345 12.6243C97.5594 12.389 97.2081 12.2713 96.7805 12.2713H94.5632V10.9886ZM105.066 16V8.36364H106.552V11.5653H107.268L109.789 8.36364H111.628L108.67 12.0774L111.663 16H109.819L107.517 12.9474H106.552V16H105.066ZM115.04 16.169C114.556 16.169 114.119 16.0795 113.727 15.9006C113.336 15.7183 113.026 15.4548 112.798 15.1101C112.572 14.7654 112.46 14.3428 112.46 13.8423C112.46 13.4115 112.543 13.0568 112.708 12.7784C112.874 12.5 113.098 12.2796 113.379 12.1172C113.661 11.9548 113.976 11.8321 114.324 11.7493C114.672 11.6664 115.027 11.6035 115.388 11.5604C115.845 11.5073 116.217 11.4643 116.502 11.4311C116.787 11.3946 116.994 11.3366 117.123 11.2571C117.252 11.1776 117.317 11.0483 117.317 10.8693V10.8345C117.317 10.4003 117.194 10.0639 116.949 9.82528C116.707 9.58665 116.346 9.46733 115.865 9.46733C115.365 9.46733 114.97 9.57836 114.682 9.80043C114.397 10.0192 114.2 10.2628 114.09 10.5312L112.693 10.2131C112.859 9.74905 113.101 9.37453 113.419 9.08949C113.741 8.80114 114.11 8.59233 114.528 8.46307C114.945 8.33049 115.385 8.2642 115.845 8.2642C116.15 8.2642 116.473 8.30066 116.815 8.37358C117.16 8.44318 117.481 8.57244 117.779 8.76136C118.081 8.95028 118.328 9.22041 118.52 9.57173C118.712 9.91974 118.808 10.3722 118.808 10.929V16H117.357V14.956H117.297C117.201 15.1482 117.057 15.3371 116.865 15.5227C116.672 15.7083 116.425 15.8625 116.124 15.9851C115.822 16.1077 115.461 16.169 115.04 16.169ZM115.363 14.9759C115.774 14.9759 116.125 14.8946 116.417 14.7322C116.712 14.5698 116.936 14.3577 117.088 14.0959C117.244 13.8307 117.322 13.5473 117.322 13.2457V12.2614C117.269 12.3144 117.166 12.3641 117.014 12.4105C116.865 12.4536 116.694 12.4917 116.502 12.5249C116.309 12.5547 116.122 12.5829 115.94 12.6094C115.758 12.6326 115.605 12.6525 115.482 12.669C115.194 12.7055 114.931 12.7668 114.692 12.853C114.457 12.9392 114.268 13.0634 114.125 13.2259C113.986 13.3849 113.916 13.5971 113.916 13.8622C113.916 14.2301 114.052 14.5085 114.324 14.6974C114.596 14.883 114.942 14.9759 115.363 14.9759ZM120.788 16V8.36364H122.275V11.5653H122.991L125.511 8.36364H127.351L124.393 12.0774L127.386 16H125.541L123.239 12.9474H122.275V16H120.788ZM132.245 8.36364H133.702V14.7124H136.342V8.36364H137.799V14.7124H140.439V8.36364H141.895V16H132.245V8.36364ZM146.102 16.169C145.619 16.169 145.181 16.0795 144.79 15.9006C144.399 15.7183 144.089 15.4548 143.86 15.1101C143.635 14.7654 143.522 14.3428 143.522 13.8423C143.522 13.4115 143.605 13.0568 143.771 12.7784C143.936 12.5 144.16 12.2796 144.442 12.1172C144.724 11.9548 145.039 11.8321 145.387 11.7493C145.735 11.6664 146.089 11.6035 146.45 11.5604C146.908 11.5073 147.279 11.4643 147.564 11.4311C147.849 11.3946 148.056 11.3366 148.186 11.2571C148.315 11.1776 148.379 11.0483 148.379 10.8693V10.8345C148.379 10.4003 148.257 10.0639 148.012 9.82528C147.77 9.58665 147.408 9.46733 146.928 9.46733C146.427 9.46733 146.033 9.57836 145.744 9.80043C145.459 10.0192 145.262 10.2628 145.153 10.5312L143.756 10.2131C143.922 9.74905 144.164 9.37453 144.482 9.08949C144.803 8.80114 145.173 8.59233 145.59 8.46307C146.008 8.33049 146.447 8.2642 146.908 8.2642C147.213 8.2642 147.536 8.30066 147.877 8.37358C148.222 8.44318 148.544 8.57244 148.842 8.76136C149.143 8.95028 149.39 9.22041 149.583 9.57173C149.775 9.91974 149.871 10.3722 149.871 10.929V16H148.419V14.956H148.36C148.263 15.1482 148.119 15.3371 147.927 15.5227C147.735 15.7083 147.488 15.8625 147.186 15.9851C146.885 16.1077 146.523 16.169 146.102 16.169ZM146.426 14.9759C146.837 14.9759 147.188 14.8946 147.48 14.7322C147.775 14.5698 147.998 14.3577 148.151 14.0959C148.307 13.8307 148.384 13.5473 148.384 13.2457V12.2614C148.331 12.3144 148.229 12.3641 148.076 12.4105C147.927 12.4536 147.756 12.4917 147.564 12.5249C147.372 12.5547 147.185 12.5829 147.002 12.6094C146.82 12.6326 146.668 12.6525 146.545 12.669C146.257 12.7055 145.993 12.7668 145.754 12.853C145.519 12.9392 145.33 13.0634 145.188 13.2259C145.048 13.3849 144.979 13.5971 144.979 13.8622C144.979 14.2301 145.115 14.5085 145.387 14.6974C145.658 14.883 146.005 14.9759 146.426 14.9759ZM157.742 5.51989L158.359 6.45952C158.13 6.66832 157.87 6.81747 157.578 6.90696C157.29 6.99313 156.957 7.04782 156.579 7.07102C156.201 7.09091 155.768 7.10914 155.281 7.12571C154.731 7.14228 154.279 7.2616 153.924 7.48366C153.569 7.70241 153.296 8.02723 153.104 8.4581C152.915 8.88565 152.792 9.42258 152.736 10.0689H152.83C153.079 9.59493 153.424 9.24029 153.864 9.00497C154.308 8.76965 154.807 8.65199 155.361 8.65199C155.977 8.65199 156.526 8.79285 157.006 9.07457C157.487 9.3563 157.865 9.76894 158.14 10.3125C158.418 10.8527 158.558 11.514 158.558 12.2962C158.558 13.0883 158.412 13.7727 158.12 14.3494C157.832 14.9261 157.424 15.3719 156.897 15.6868C156.373 15.9983 155.755 16.1541 155.043 16.1541C154.33 16.1541 153.709 15.9934 153.178 15.6719C152.651 15.3471 152.242 14.8665 151.95 14.2301C151.662 13.5937 151.518 12.8082 151.518 11.8736V11.1179C151.518 9.37121 151.829 8.05705 152.452 7.17543C153.076 6.2938 154.007 5.84138 155.246 5.81818C155.647 5.80824 156.005 5.80658 156.32 5.81321C156.635 5.81652 156.91 5.80161 157.146 5.76847C157.384 5.73201 157.583 5.64915 157.742 5.51989ZM155.048 14.9062C155.462 14.9062 155.818 14.8018 156.116 14.593C156.418 14.3809 156.65 14.081 156.812 13.6932C156.975 13.3054 157.056 12.848 157.056 12.321C157.056 11.804 156.975 11.3648 156.812 11.0036C156.65 10.6423 156.418 10.3672 156.116 10.1783C155.815 9.98603 155.454 9.88991 155.033 9.88991C154.721 9.88991 154.443 9.9446 154.197 10.054C153.952 10.16 153.742 10.3175 153.566 10.5263C153.394 10.7351 153.259 10.9903 153.163 11.2919C153.071 11.5902 153.021 11.9332 153.014 12.321C153.014 13.1098 153.195 13.7379 153.556 14.2053C153.921 14.6726 154.418 14.9062 155.048 14.9062ZM159.616 16L159.612 14.7124H159.885C160.097 14.7124 160.274 14.6676 160.417 14.5781C160.563 14.4853 160.682 14.3295 160.775 14.1108C160.868 13.892 160.939 13.5904 160.989 13.206C161.038 12.8182 161.075 12.331 161.098 11.7443L161.232 8.36364H166.562V16H165.105V9.64631H162.609L162.49 12.2415C162.46 12.8712 162.396 13.4214 162.296 13.892C162.2 14.3627 162.059 14.7554 161.874 15.0703C161.688 15.3819 161.449 15.6155 161.158 15.7713C160.866 15.9238 160.511 16 160.094 16H159.616ZM171.761 16.1541C171.045 16.1541 170.42 15.9901 169.887 15.6619C169.353 15.3338 168.939 14.8748 168.644 14.2848C168.349 13.6948 168.201 13.0054 168.201 12.2166C168.201 11.4245 168.349 10.7318 168.644 10.1385C168.939 9.54522 169.353 9.08452 169.887 8.75639C170.42 8.42827 171.045 8.2642 171.761 8.2642C172.477 8.2642 173.102 8.42827 173.635 8.75639C174.169 9.08452 174.583 9.54522 174.878 10.1385C175.173 10.7318 175.32 11.4245 175.32 12.2166C175.32 13.0054 175.173 13.6948 174.878 14.2848C174.583 14.8748 174.169 15.3338 173.635 15.6619C173.102 15.9901 172.477 16.1541 171.761 16.1541ZM171.766 14.9062C172.23 14.9062 172.614 14.7836 172.919 14.5384C173.224 14.2931 173.45 13.9666 173.595 13.5589C173.744 13.1513 173.819 12.7022 173.819 12.2116C173.819 11.7244 173.744 11.277 173.595 10.8693C173.45 10.4583 173.224 10.1286 172.919 9.87997C172.614 9.63139 172.23 9.5071 171.766 9.5071C171.298 9.5071 170.911 9.63139 170.602 9.87997C170.298 10.1286 170.07 10.4583 169.921 10.8693C169.776 11.277 169.703 11.7244 169.703 12.2116C169.703 12.7022 169.776 13.1513 169.921 13.5589C170.07 13.9666 170.298 14.2931 170.602 14.5384C170.911 14.7836 171.298 14.9062 171.766 14.9062ZM182.155 11.5405V12.8281H178.019V11.5405H182.155ZM178.436 8.36364V16H176.98V8.36364H178.436ZM183.194 8.36364V16H181.743V8.36364H183.194Z"
        fill="#22075E"/>
    </svg>
  );
};

const CrossSvg = (props: React.SVGProps<SVGSVGElement>) => {
  return (
    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" {...props}>
      <path fillRule="evenodd" clipRule="evenodd"
            d="M11.1618 4.83785C11.3896 5.06567 11.3896 5.43503 11.1618 5.66285L5.66187 11.1628C5.43406 11.3906 5.06469 11.3906 4.83688 11.1628C4.60906 10.935 4.60906 10.5656 4.83688 10.3378L10.3368 4.83785C10.5646 4.61004 10.934 4.61004 11.1618 4.83785Z"
            fill="black"/>
      <path fillRule="evenodd" clipRule="evenodd"
            d="M4.83688 4.83785C5.06469 4.61004 5.43406 4.61004 5.66187 4.83785L11.1618 10.3378C11.3896 10.5656 11.3896 10.935 11.1618 11.1628C10.934 11.3906 10.5646 11.3906 10.3368 11.1628L4.83688 5.66285C4.60906 5.43503 4.60906 5.06567 4.83688 4.83785Z"
            fill="black"/>
    </svg>
  );
};

type FilterPropsType = {
  pageName: string
}

const Search: FC<FilterPropsType> = ({pageName}) => {

  const dispatch = useDispatch();
  const classes = useStyles();
  const date = useAppSelector(state => state.search.date);
  const defaultCriterias = useAppSelector(state => state.search.defaultCriterias);
  const allCriterias = useAppSelector(state => state.search.allCriterias);
  const activeCriterias = useAppSelector(state => state.search.activeCriterias);

  const [loading, setLoading] = useState(false);
  const [open, setOpen] = useState(false);
  const handleClick = () => {
    setOpen(true);
  };
  const handleClose = (event?: React.SyntheticEvent | Event, reason?: string) => {
    if (reason === 'clickaway') {
      return;
    }
    setOpen(false);
  };

  const removeAllCriteriasHandler = () => {
    dispatch(searchSlice.actions.removeALlCriterias(null));
  };

  const searchRequest = async () => {
    setLoading(true);

    const convertDataForRequest = () => {
      let requestArray = [];
      for (let i = 0; i < defaultCriterias.length; i++) {
        if (defaultCriterias[i].values.length > 0) {
          requestArray.push({key: defaultCriterias[i].key, values: defaultCriterias[i].values})
        }
      }
      for (let i = 0; i < activeCriterias.length; i++) {
        if (activeCriterias[i].values.length > 0) {
          requestArray.push({key: activeCriterias[i].key, values: activeCriterias[i].values});
        }
      }
      return requestArray;
    };
    await dispatch(callsSlice.actions.setEmptyState(null));
    await dispatch(getBaseCallsData({
      skip: 0,
      limit: 10,
      date: {startDate: date.startDate, endDate: date.endDate},
      data: convertDataForRequest()
    }));
    setLoading(false);
  };

  return (
    <div style={{margin: '24px 0'}}>
      <BlockBox padding="34px 24px 10px 24px">
        <div className={classes.searchTitle}>
          <div className={classes.searchTitleLeft}>
            <Typography className={classes.searchTitleLeftText} variant="h5">{pageName}</Typography>
            <Typography className={classes.searchTitleLeftStick} variant="h6">|</Typography>
          </div>
          {activeCriterias.length > 0 && <div className={classes.searchTitleRight}>
            <div onClick={removeAllCriteriasHandler} className={classes.searchDeleteAllButton}>
              <CrossSvg style={{marginRight: '5px'}}/>
              <Typography className={classes.searchDeleteAllButtonText}>Очистить</Typography>
            </div>
            <Button
              startIcon={<FolderPlusSvg className={classes.searchButtonIcon}/>}
              color="secondary"
              variant="contained"
              onClick={handleClick}
            />
          </div>}
          <Snackbar anchorOrigin={{vertical: 'top', horizontal: 'center'}} open={open} autoHideDuration={500}
                    onClose={handleClose}>
            <Alert onClose={handleClose} severity="error" sx={{width: '100%'}}>
              Данная функция пока не работает
            </Alert>
          </Snackbar>
        </div>
        <div style={{display: 'flex', alignItems: 'flex-start', minHeight: '50px'}}>
          <div className={classes.searchItems}>
            <div>
              {defaultCriterias && allCriterias ? defaultCriterias.map(criteria => {
                const criteriaKey = criteria.key.slice(4);
                const compResult = allCriterias.filter(v => v.key === criteria.key);
                return (
                  <div className={classes.searchItem}>
                    <Typography className={classes.searchText}>{criteriaKey}</Typography>
                    <Select criteriaFull={compResult[0]} criteriaCurrent={criteria}/>
                  </div>
                )
              }) : null}
            </div>
            {activeCriterias && allCriterias ? activeCriterias.map(criteria => {
              const compResult = allCriterias.filter(v => v.key === criteria.key);
              return (
                <div className={classes.searchItem}>
                  <Typography className={classes.searchText}>{criteria.title}</Typography>
                  <Select criteriaFull={compResult[0]} criteriaCurrent={criteria}/>
                </div>
              )
            }) : null}
          </div>
          <div style={{display: 'flex', alignItems: 'center'}}>
            <LoadingButton
              startIcon={<SearchIcon/>}
              color="primary"
              variant="contained"
              loading={loading}
              loadingPosition="start"
              onClick={searchRequest}
            >
              Искать
            </LoadingButton>
            <SelectTwo criterias={allCriterias}/>
          </div>
        </div>
      </BlockBox>
    </div>
  );
};

export default Search;
